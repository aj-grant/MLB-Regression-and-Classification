<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Logistic regression | Machine Learning for Biostatistics</title>
  <meta name="description" content="3 Logistic regression | Machine Learning for Biostatistics" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Logistic regression | Machine Learning for Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Logistic regression | Machine Learning for Biostatistics" />
  
  
  

<meta name="author" content="Armando Teixeira-Pinto" />


<meta name="date" content="2025-07-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="k-nearest-neighbours-regression.html"/>
<link rel="next" href="linear-discriminant-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="bca.png"><H3><b><font color="F26531"> Machine Learning for Biostatistics </font> </b></H3> <a href="https://canvas.sydney.edu.au/courses/66692/modules" style="color:364550" target="blank"><small><i> Back to canvas website </i></small></a></center></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Regression and Classification</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#datasets-used-in-the-examples"><i class="fa fa-check"></i>Datasets used in the examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#slides-from-the-videos"><i class="fa fa-check"></i>Slides from the videos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html#LR.intro"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="linear-regression.html"><a href="linear-regression.html#LR.readings"><i class="fa fa-check"></i><b>1.2</b> Readings</a></li>
<li class="chapter" data-level="1.3" data-path="linear-regression.html"><a href="linear-regression.html#LR.practice"><i class="fa fa-check"></i><b>1.3</b> Practice session</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#task-1---fit-a-linear-model"><i class="fa fa-check"></i>Task 1 - Fit a linear model</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#task-2---predicting-from-a-linear-model"><i class="fa fa-check"></i>Task 2 - Predicting from a linear model</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="linear-regression.html"><a href="linear-regression.html#LR.exerc"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html"><i class="fa fa-check"></i><b>2</b> K-nearest Neighbours Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html#knn.intro"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html#knn.read"><i class="fa fa-check"></i><b>2.2</b> Readings</a></li>
<li class="chapter" data-level="2.3" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html#knn.prac"><i class="fa fa-check"></i><b>2.3</b> Practical session</a>
<ul>
<li class="chapter" data-level="" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html#task---fit-a-knn-regression"><i class="fa fa-check"></i>Task - Fit a knn regression</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="k-nearest-neighbours-regression.html"><a href="k-nearest-neighbours-regression.html#knn.exerc"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#lr.intro"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lr.read"><i class="fa fa-check"></i><b>3.2</b> Readings</a></li>
<li class="chapter" data-level="3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#lr.prac"><i class="fa fa-check"></i><b>3.3</b> Practical session</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#task---logistic-regression"><i class="fa fa-check"></i>Task - Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#lr.exerc"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html"><i class="fa fa-check"></i><b>4</b> Linear Discriminant Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#lda.intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#lda.read"><i class="fa fa-check"></i><b>4.2</b> Readings</a></li>
<li class="chapter" data-level="4.3" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#lda.prac"><i class="fa fa-check"></i><b>4.3</b> Practical session</a>
<ul>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#task-1---classification-with-the-linear-discriminant-function"><i class="fa fa-check"></i>Task 1 - Classification with the linear discriminant function</a></li>
<li class="chapter" data-level="" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#task-2---classification-with-the-quadratic-discriminant-function"><i class="fa fa-check"></i>Task 2 - Classification with the quadratic discriminant function</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#lda.exerc"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html"><i class="fa fa-check"></i><b>5</b> K-nearest Neighbours Classification</a>
<ul>
<li class="chapter" data-level="5.1" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html#knnc.intro"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html#knnc.read"><i class="fa fa-check"></i><b>5.2</b> Readings</a></li>
<li class="chapter" data-level="5.3" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html#knnc.prac"><i class="fa fa-check"></i><b>5.3</b> Practical session</a>
<ul>
<li class="chapter" data-level="" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html#task---knn-classification"><i class="fa fa-check"></i>Task - KNN classification</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="k-nearest-neighbours-classification.html"><a href="k-nearest-neighbours-classification.html#knnc.exerc"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><center><a href="https://canvas.sydney.edu.au/courses/66692/modules" style="color:364550" target="blank"><img src="usyd2.gif" width="60%"></a> <small>© A.Teixeira-Pinto, University of Sydney, 2021</small></center></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="../_book">Machine Learning for Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Logistic regression<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lr.intro" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction<a href="logistic-regression.html#lr.intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You should also be familiar with logistic regression but not necessarily
as a classification method. In this section, we will see how this model can
be used to make predictions for categorical outcomes.
Like the linear model, there will be several
aspects, such as hypothesis testing, that we will not discussed in detail.</p>
<iframe width="784" height="441" src="https://www.youtube.com/embed/bTlBFao6NFQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="lr.read" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Readings<a href="logistic-regression.html#lr.read" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read the following chapters of <em>An introduction to statistical learning</em>:</p>
<ul>
<li>4.2 Why not Linear Regression?</li>
<li>4.3 Logistic Regression</li>
<li>Read about the <em>Confusion Matrix</em> and <em>ROC curve</em> in the
subchapter 4.4.2</li>
</ul>
</div>
<div id="lr.prac" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Practical session<a href="logistic-regression.html#lr.prac" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="task---logistic-regression" class="section level3 unnumbered hasAnchor">
<h3>Task - Logistic regression<a href="logistic-regression.html#task---logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the <a href="https://www.dropbox.com/s/7wjsfdaf0wt2kg2/bmd.csv?dl=1">bmd.csv</a>
dataset, let’s fit a logistic regression model to predict fracture, using AGE,
SEX, BMI and BMD as main effects.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="logistic-regression.html#cb27-1" tabindex="-1"></a><span class="co">#libraries that we will need</span></span>
<span id="cb27-2"><a href="logistic-regression.html#cb27-2" tabindex="-1"></a><span class="fu">library</span>(pROC) <span class="co">#ROC curve</span></span>
<span id="cb27-3"><a href="logistic-regression.html#cb27-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1974</span>) <span class="co">#fix the random generator seed </span></span>
<span id="cb27-4"><a href="logistic-regression.html#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="logistic-regression.html#cb27-5" tabindex="-1"></a><span class="co">#read the data</span></span>
<span id="cb27-6"><a href="logistic-regression.html#cb27-6" tabindex="-1"></a>bmd.data     <span class="ot">&lt;-</span> </span>
<span id="cb27-7"><a href="logistic-regression.html#cb27-7" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">&quot;https://www.dropbox.com/s/c6mhgatkotuze8o/bmd.csv?dl=1&quot;</span>, </span>
<span id="cb27-8"><a href="logistic-regression.html#cb27-8" tabindex="-1"></a>           <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-9"><a href="logistic-regression.html#cb27-9" tabindex="-1"></a>  </span>
<span id="cb27-10"><a href="logistic-regression.html#cb27-10" tabindex="-1"></a>bmd.data<span class="sc">$</span>bmi <span class="ot">&lt;-</span> bmd.data<span class="sc">$</span>weight_kg <span class="sc">/</span> (bmd.data<span class="sc">$</span>height_cm<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="logistic-regression.html#cb28-1" tabindex="-1"></a><span class="co">#Fits a logistic model with fixed effects only  </span></span>
<span id="cb28-2"><a href="logistic-regression.html#cb28-2" tabindex="-1"></a>  model1.fracture <span class="ot">&lt;-</span> <span class="fu">glm</span>(fracture<span class="sc">==</span><span class="st">&quot;fracture&quot;</span> <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> bmi <span class="sc">+</span> bmd, </span>
<span id="cb28-3"><a href="logistic-regression.html#cb28-3" tabindex="-1"></a>                         <span class="at">family=</span>binomial, <span class="at">data =</span> bmd.data)</span>
<span id="cb28-4"><a href="logistic-regression.html#cb28-4" tabindex="-1"></a>  <span class="fu">summary</span>(model1.fracture)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = fracture == &quot;fracture&quot; ~ age + sex + bmi + bmd, 
##     family = binomial, data = bmd.data)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   9.79488    2.69720   3.631 0.000282 ***
## age           0.01844    0.02094   0.881 0.378540    
## sexM          0.84599    0.51249   1.651 0.098792 .  
## bmi          -0.05131    0.06013  -0.853 0.393537    
## bmd         -15.11747    2.80337  -5.393 6.94e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 205.27  on 168  degrees of freedom
## Residual deviance: 110.86  on 164  degrees of freedom
## AIC: 120.86
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>We will use a Bayes classifier threshold (pred prob &lt;.5) to classify each
patient and then check the misclassifications using the confusion matrix.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="logistic-regression.html#cb30-1" tabindex="-1"></a><span class="co">#for model1</span></span>
<span id="cb30-2"><a href="logistic-regression.html#cb30-2" tabindex="-1"></a>model1.fracture.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1.fracture,      <span class="co">#probabilities </span></span>
<span id="cb30-3"><a href="logistic-regression.html#cb30-3" tabindex="-1"></a>                                <span class="at">type=</span><span class="st">&quot;response&quot;</span>)      <span class="co">#predicted by the model</span></span>
<span id="cb30-4"><a href="logistic-regression.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="logistic-regression.html#cb30-5" tabindex="-1"></a><span class="co">#if prob&gt;.5 returns TRUE (fracture)                  </span></span>
<span id="cb30-6"><a href="logistic-regression.html#cb30-6" tabindex="-1"></a>model1.fracture.class <span class="ot">&lt;-</span> model1.fracture.pred <span class="sc">&gt;</span> .<span class="dv">5</span>    </span>
<span id="cb30-7"><a href="logistic-regression.html#cb30-7" tabindex="-1"></a></span>
<span id="cb30-8"><a href="logistic-regression.html#cb30-8" tabindex="-1"></a><span class="co">#now build the confusion matrix</span></span>
<span id="cb30-9"><a href="logistic-regression.html#cb30-9" tabindex="-1"></a><span class="fu">table</span>(model1.fracture.class, bmd.data<span class="sc">$</span>fracture)     </span></code></pre></div>
<pre><code>##                      
## model1.fracture.class fracture no fracture
##                 FALSE       15         110
##                 TRUE        35           9</code></pre>
<p>So, from the table above you can see that based on the cut-off for
the predictive probability of 0.5, the model predicted 35 out of
the 50 fractures. And it predicted 110 out of the 119 no fractures.</p>
<p>Let’s now plot the ROC and calculate the area under the curve. There are
several packages in R to do this; we will be using the library pROC.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="logistic-regression.html#cb32-1" tabindex="-1"></a>  auc.model1.fracture <span class="ot">&lt;-</span> <span class="fu">roc</span>(fracture <span class="sc">~</span> model1.fracture.pred, <span class="co">#using the pred prob</span></span>
<span id="cb32-2"><a href="logistic-regression.html#cb32-2" tabindex="-1"></a>                             <span class="at">data =</span> bmd.data)                 <span class="co">#from the model</span></span></code></pre></div>
<pre><code>## Setting levels: control = fracture, case = no fracture</code></pre>
<pre><code>## Setting direction: controls &gt; cases</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="logistic-regression.html#cb35-1" tabindex="-1"></a>  auc.model1.fracture</span></code></pre></div>
<pre><code>## 
## Call:
## roc.formula(formula = fracture ~ model1.fracture.pred, data = bmd.data)
## 
## Data: model1.fracture.pred in 50 controls (fracture fracture) &gt; 119 cases (fracture no fracture).
## Area under the curve: 0.9195</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="logistic-regression.html#cb37-1" tabindex="-1"></a>  <span class="fu">plot</span>(auc.model1.fracture) </span>
<span id="cb37-2"><a href="logistic-regression.html#cb37-2" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.6</span>,.<span class="dv">6</span>, <span class="fu">paste</span>(<span class="st">&quot;AUC = &quot;</span>, <span class="fu">round</span>(auc.model1.fracture<span class="sc">$</span>auc,<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p><strong>TRY IT YOURSELF:</strong>
1) Fit a similar model to model1.fracture but add a quadratic effect for age,
i.e., I(age^2) and compare the AIC of both models.</p>
<details>
<summary>
<em>See the solution code</em>
</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="logistic-regression.html#cb38-1" tabindex="-1"></a><span class="co">#Fits a logistic model as model1.fracture but adds the quadratic effect for age</span></span>
<span id="cb38-2"><a href="logistic-regression.html#cb38-2" tabindex="-1"></a>    model2.fracture <span class="ot">&lt;-</span> <span class="fu">glm</span>(fracture<span class="sc">==</span><span class="st">&quot;fracture&quot;</span> <span class="sc">~</span> age <span class="sc">+</span>  <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> bmi <span class="sc">+</span></span>
<span id="cb38-3"><a href="logistic-regression.html#cb38-3" tabindex="-1"></a>                                                  sex <span class="sc">+</span> bmd,  </span>
<span id="cb38-4"><a href="logistic-regression.html#cb38-4" tabindex="-1"></a>                         <span class="at">family=</span>binomial, <span class="at">data =</span> bmd.data)</span>
<span id="cb38-5"><a href="logistic-regression.html#cb38-5" tabindex="-1"></a>    <span class="fu">summary</span>(model2.fracture)</span></code></pre></div>
</details>
<p>
<p>
<ol start="2" style="list-style-type: decimal">
<li>Compute the classification error for the Bayes classifier using the confusion
matrix.</li>
</ol>
<details>
<summary>
<em>See the solution code</em>
</summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="logistic-regression.html#cb39-1" tabindex="-1"></a><span class="co">#Produce the confusion matrices for the models fitted</span></span>
<span id="cb39-2"><a href="logistic-regression.html#cb39-2" tabindex="-1"></a>model2.fracture.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2.fracture,     <span class="co">#probabilities predicted </span></span>
<span id="cb39-3"><a href="logistic-regression.html#cb39-3" tabindex="-1"></a>                                <span class="at">type=</span><span class="st">&quot;response&quot;</span>)     <span class="co">#by the model</span></span>
<span id="cb39-4"><a href="logistic-regression.html#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="logistic-regression.html#cb39-5" tabindex="-1"></a><span class="co">#if prob&gt;.5 returns TRUE (fracture)</span></span>
<span id="cb39-6"><a href="logistic-regression.html#cb39-6" tabindex="-1"></a>model2.fracture.class <span class="ot">&lt;-</span> model2.fracture.pred <span class="sc">&gt;</span>.<span class="dv">5</span>    </span>
<span id="cb39-7"><a href="logistic-regression.html#cb39-7" tabindex="-1"></a></span>
<span id="cb39-8"><a href="logistic-regression.html#cb39-8" tabindex="-1"></a><span class="co">#confusion matrix</span></span>
<span id="cb39-9"><a href="logistic-regression.html#cb39-9" tabindex="-1"></a><span class="fu">table</span>(model2.fracture.class, bmd.data<span class="sc">$</span>fracture)      </span></code></pre></div>
</details>
<p>
<p>
<ol start="3" style="list-style-type: decimal">
<li>Plot the ROC curve</li>
</ol>
<details>
<summary>
<em>See the solution code</em>
</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="logistic-regression.html#cb40-1" tabindex="-1"></a><span class="co">#ROC</span></span>
<span id="cb40-2"><a href="logistic-regression.html#cb40-2" tabindex="-1"></a>  <span class="co">#using the pred prob from the model</span></span>
<span id="cb40-3"><a href="logistic-regression.html#cb40-3" tabindex="-1"></a>  auc.model2.fracture <span class="ot">&lt;-</span> <span class="fu">roc</span>(fracture <span class="sc">~</span> model2.fracture.pred, </span>
<span id="cb40-4"><a href="logistic-regression.html#cb40-4" tabindex="-1"></a>                               <span class="at">data =</span> bmd.data)               </span></code></pre></div>
<pre><code>## Setting levels: control = fracture, case = no fracture</code></pre>
<pre><code>## Setting direction: controls &gt; cases</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="logistic-regression.html#cb43-1" tabindex="-1"></a>  auc.model2.fracture</span>
<span id="cb43-2"><a href="logistic-regression.html#cb43-2" tabindex="-1"></a>  <span class="fu">plot</span>(auc.model2.fracture) </span>
<span id="cb43-3"><a href="logistic-regression.html#cb43-3" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.6</span>,.<span class="dv">6</span>, <span class="fu">paste</span>(<span class="st">&quot;AUC = &quot;</span>, <span class="fu">round</span>(auc.model2.fracture<span class="sc">$</span>auc,<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
<div id="lr.exerc" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Exercises<a href="logistic-regression.html#lr.exerc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>The dataset <a href="https://www.dropbox.com/s/vp44yozebx5xgok/bdiag.csv?dl=1">bdiag.csv</a>,
included several imaging details from patients that had a biopsy to test for
breast cancer.<br />
The variable <strong>Diagnosis</strong> classifies the biopsied tissue as M = malignant or
B = benign.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Fit a logistic regression to predict <strong>Diagnosis</strong> using <strong>texture_mean</strong>
and <strong>radius_mean</strong>.</p></li>
<li><p>Build the confusion matrix for the model above</p></li>
<li><p>Calculate the area and the ROC curve for the model in a).</p></li>
<li><p>Plot the scatter plot for <strong>texture_mean</strong>
and <strong>radius_mean</strong> and draw the border line for the prediction of
<strong>Diagnosis</strong> based on the model in a)</p></li>
<li><p>If you wanted to use the model above to predict the result of the biopsy,
but wanted to decrease the chances of a false negative test, what strategy
could you use?</p></li>
</ol></li>
<li><p>The <a href="https://www.dropbox.com/s/da3by5vuzkv77xi/SBI.csv?dl=1">SBI.csv</a> dataset
contains the information of more than 2300 children that attended the
emergency services with fever and were tested for serious bacterial infection.
The outcome <strong>sbi</strong> has 4 categories: Not Applicable(no infection) / UTI / Pneum / Bact</p>
<ol style="list-style-type: lower-alpha">
<li><p>Build a multinomial model using <strong>wcc</strong>, <strong>age</strong>, <strong>prevAB</strong>, <strong>pct</strong>,
and <strong>crp</strong> to predict <strong>sbi</strong></p></li>
<li><p>Compute the confusion matrix and compute the kappa statistics</p></li>
<li><p>How does the model classify a child with 1 year of age, WCC=29,
PCT=5, CRP=200 and no prevAB?</p></li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="k-nearest-neighbours-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-discriminant-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
